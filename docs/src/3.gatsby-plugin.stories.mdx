import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Gatsby Plugin" />

<Grid sx={{ alignItems: 'center', gridTemplateColumns: '30px auto', gridGrap: '8px' }}>
  <Image src="/gatsby-logo.png" sx={{ width: '30px', height: '30px' }} />
  <Heading as="h1">Install</Heading>
</Grid>

```sh
npm install gatsby-plugin-mdx-embed --save
```

### Install peer dependencies

```js
npm install mdx-embed gatsby-plugin-mdx @mdx-js/mdx @mdx-js/react --save
```

### Add to gatsby-config.js

Once you've installed the dependencies add `gatsby-plugin-mdx` and `gatsby-plugin-mdx-embed`to your`gatsby.config.js` plugins array.

```javascript
// gatsby-config.js
module.exports = {
   module.exports = {
  ...
  plugins: [`gatsby-plugin-mdx`, `gatsby-plugin-mdx-embed`]
  ...
}
```

The Gatsby plugin works by wrapping the Gatsby "Root Element" with the `MDXEmbedProvider`. If you encounter any issues with the plugin you could try manually including the `MDXEmbedProvider` by adding the following to `gatsby-browser.js` and/or `gatsby-ssr.js`

```javascript
// gatsby-browser.js || gatsby-ssr.js
import React from 'react';
import { MDXEmbedProvider } from 'mdx-embed';

export const wrapRootElement = ({ element }) => {
  return <MDXEmbedProvider>{element}</MDXEmbedProvider>;
};
```

## Migration

If you were a user of `@pauliescanlon/gatsby-mdx-embed` here's how you can migrate to the new package and plugin.

**1. Remove the old plugin**

```sh
npm uninstall @paliescanlon/gatsby-mdx-embed
```

**2. Install the new dependencies**

```sh
npm install mdx-embed gatsby-plugin-mdx-embed
```

**3. Remove the old plugin from `gatsby-config.js` and add the new plugin**

```diff
// gatsby-config.js
...
plugins: [
- `@pauliescanlon/gatsby-mdx-embed`
+ gatsby-plugin-mdx-embed
]
...
```
